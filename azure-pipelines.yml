trigger: 
  - main

pool:
  vmImage: ubuntu-latest

variables:

  DOTNET_VERSION: '8.0.x'
  BUILD_CONFIGURATION: 'Release'
  PUBLISH_DIR: '$(Build.ArtifactStagingDirectory)/publish'
  ARTIFACT_NAME: 'drop'
  WEB_PROJECT: 'src/DotNetWebApp/DotNetWebApp.csproj'

  # App Names
  APP_DEV: 'mywebapp-dev-12345'
  APP_STG: 'mywebapp-staging-12345'
  APP_PRD: 'mywebapp-prod-12345'

  # Resource Groups
  RG_NONPROD: 'rg-staging-webapp'
  RG_PROD: 'rg-prod-webapp'

  # Service Connections
  AZURE_SERVICE_CONNECTION: 'Appconnec'

  stages:
  - stage: Build_Test
  displayName: "CI â€” Build and Test"
  jobs:
  - job: BuildJob
    steps:
    - task: UseDotNet@2
      displayName: 'Use .NET SDK'
      inputs:
        packageType: 'sdk'
        version: '$(DOTNET_VERSION)'

        -task: DotNetCoreCLI@2
          inputs:
            command: 'restore'
                projects: 'src/DotNetWebApp'
                feedsToUse: 'select'
                vstsFeed: '049291ea-8785-42f3-b7c8-c7c84cd3506d'
- task: DotNetCoreCLI@2
  inputs:
    command: 'build'
    projects: 'src/DotNetWebApp'
    arguments: 'DotNetWebApp.sln'


- task: DotNetCoreCLI@2
  inputs:
    command: 'test'
    projects: 'tests/DotNetWebApp.Tests/DotNetWebApp.Tests.csproj'

    